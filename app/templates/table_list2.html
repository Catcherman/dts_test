{% extends "base.html" %}
{% import "_macros.html" as macros %}
{% block title %}D T S{% endblock %}

{% block page_content %}

<div class="col-md-9">
     <div class="btn-group btn-group-lg" role="group" aria-label="...">
      <a herf="{{ url_for('main.newbug') }}">
      <button type="button" class="btn btn-primary">标准流程</button></a>
      <button type="button" class="btn btn-info">简易流程</button>
      <button type="button" class="btn btn-default">Right5</button>
     </div>
    <hr>
    <div class="btn-group btn-group-lg">
       <button type="button" class="btn btn-default">选择列</button>
       <button type="button" class="btn btn-default dropdown-toggle"
          data-toggle="dropdown">
          <span class="caret"></span>
          <span class="sr-only">切换下拉菜单</span>
       </button>
       <ul class="dropdown-menu" role="menu">
          <li><a href="#">功能</a></li>
          <li><a href="#">另一个功能</a></li>
          <li><a href="#">其他</a></li>
          <li class="divider"></li>
          <li><a href="#">分离的链接</a></li>
       </ul>

    <div class="btn-group btn-group-lg">
       <button type="button" class="btn btn-primary">导出数据</button>
       <button type="button" class="btn btn-primary dropdown-toggle"
          data-toggle="dropdown">
          <span class="caret"></span>
          <span class="sr-only">切换下拉菜单</span>
       </button>
       <ul class="dropdown-menu" role="menu">
          <li><a href="#">功能</a></li>
          <li><a href="#">另一个功能</a></li>
          <li><input type="text" class="form-control"></input></li>
          <li class="divider"></li>
          <li><a href="#">分离的链接</a></li>
        </ul>
    </div>
    <div class="row">
       <form class="bs-example bs-example-form" role="form">
        <div class="input-group">
           <input type="text" class="form-control">
           <span class="input-group-btn">
              <button class="btn btn-default" type="button">
                 Go!
              </button>
           </span>
        </div><!-- /input-group -->
       </form><!-- bs-example -->
    </div>
    <hr>

    {% include 'table.html' %}

    {% if pagination %}
    <div class="pagination">
        {{ macros.pagination_widget(pagination, '.myjson') }}
    </div>
    {% endif %}


{% endblock %}

{% block scripts %}
{{ super() }}
{{ moment.include_moment() }}
<script src="static/pagination/jquery.pagination.js" type="text/javascript"></script>
<script src="static/pagination/pagination.css" type="text/css"></script>

<script language="javascript" type="text/javascript">
 var pageIndex =0;     //页索引
 var pageSize =20;    //每页显示的条数
    $(function() {
    Init(0);
        $("#Pagination").pagination(43, {
             callback: PageCallback,
             prev_text: '上一页',
             next_text: '下一页',
             items_per_page: pageSize,
             num_display_entries: 5,
             current_page: pageIndex,
             num_edge_entries: 1
         });
         function PageCallback(index, jq) {
              Init(index);
         }
    });

    function Init(pageIndex) {
        $.ajax({
            type: "GET",
            dataType: "json",
            url: 'myjson',
            data: "pageIndex=" + (pageIndex + 1) + "&pageSize=" + pageSize,
            success: function(json) {
                if(json!=""){
                 alert("JSON Data count: " + json.pages);
                 $("#result").text(json.posts[0].product_name);
                 $("#buglist").empty();//移除所有的数据行
                 for(var i=0;i< json.count;i++){
                    $("#buglist").append(
                    '<tr>'+json.pages+'</tr>'+
                    '<tr>'+
                    '<td><input type="checkbox"></input></td>'+
                    '<td>'+(i+1)+'</td>'+
                    '<td>'+'<a href='+json.posts[i].url+'>'+json.posts[i].id+'</a></td>'+
                    '<td>'+json.posts[i].product_name+'</td>'+
                    '<td>'+json.posts[i].product_version+'</td>'+
                    '<td>'+json.posts[i].software_version+'</td>'+
                    '<td>'+json.posts[i].bug_level+'</td>'+
                    '<td>'+json.posts[i].bug_show_times+'</td>'+
                    '<td>'+json.posts[i].bug_title+'</td>'+
                    '<td>'+json.posts[i].author+'</td>'+
                    '<td>'+json.posts[i].bug_status+'</td>'+
                    '<td>'+json.posts[i].bug_owner+'</td>'+
                    '<td>'+json.posts[i].timestamp+'</td>'+
                    '</tr>');
                    }
                }
            }
        });

    }
</script>

{% endblock %}

